<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>La Form</title>
<link rel="stylesheet" type="text/css"
	href="https://cdn.jsdelivr.net/gh/bmabey/pyLDAvis@3.4.0/pyLDAvis/js/ldavis.v1.0.0.css">
<!-- Favicon -->
<link href="${pageContext.request.contextPath}/resources/img/ÌîÑÎ¶¨ÏßÄÏïÑ.png"
	rel="icon" type="image/png">
<!-- Fonts -->
<link
	href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700"
	rel="stylesheet">
<!-- Icons -->
<link
	href="${pageContext.request.contextPath}/resources/js/plugins/nucleo/css/nucleo.css"
	rel="stylesheet" />
<link
	href="${pageContext.request.contextPath}/resources/js/plugins/@fortawesome/fontawesome-free/css/all.min.css"
	rel="stylesheet" />
<!-- CSS Files -->
<link
	href="${pageContext.request.contextPath}/resources/css/argon-dashboard.css?v=1.1.2"
	rel="stylesheet" />
<link rel="stylesheet"
	href="${pageContext.request.contextPath}/resources/css/sakura.css" />
<style type="text/css">
.table-responsive {
	max-height: 300px;
	overflow-y: auto;
}
</style>
</head>

<!-- body -->

<body class="scrollbar">
	<div id="particle-1"></div>
	<nav
		class="navbar navbar-vertical fixed-left navbar-expand-md navbar-light bg-white"
		id="sidenav-main" style="padding: 1;">
		<div class="container-fluid">

			<!-- Toggler -->
			<button class="navbar-toggler" type="button" data-toggle="collapse"
				data-target="#sidenav-collapse-main" aria-controls="sidenav-main"
				aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>

			<!-- Brand -->
			<a class="navbar-brand pt-0" href="dashboard.do"> <img
				src="${pageContext.request.contextPath}/resources/img/Î∞∞ÎÑà2.png"
				class="navbar-brand-img" alt="...">
			</a>

			<!-- User -->
			<ul class="nav align-items-center d-md-none">
				<li class="nav-item dropdown"><a class="nav-link nav-link-icon"
					href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
					aria-expanded="false"></li>
				<li class="nav-item dropdown"><a class="nav-link" href="#"
					role="button" data-toggle="dropdown" aria-haspopup="true"
					aria-expanded="false">
						<div class="media align-items-center">
							<span class="avatar avatar-sm rounded-circle"> <img
								alt="Image placeholder"
								src="${pageContext.request.contextPath}/resources/img/ÌîÑÎ¶¨ÏßÄÏïÑ.png">
							</span>
						</div>
				</a>
					<div class="dropdown-menu dropdown-menu-arrow dropdown-menu-right">
						<div class=" dropdown-header noti-title">
							<h6 class="text-overflow m-0">Welcome!</h6>
						</div>
						<div class="dropdown-divider"></div>
						<a href="logout.do" class="dropdown-item"> <i
							class="ni ni-user-run"></i> <span>Logout</span>
						</a>
					</div></li>
			</ul>

			<!-- Collapse -->
			<div class="collapse navbar-collapse" id="sidenav-collapse-main"
				style="background: linear-gradient(30deg, #feb47b, #815EE4, #ffffff, #ffffff);">

				<!-- Ïù¥ÎØ∏ÏßÄ Î∞∞Í≤Ω -->
				<div class="collapse navbar-collapse" id="sidenav-collapse-main"
					style="background-color: #ffffff; background-size: cover;">

					<!-- Collapse header -->
					<div class="navbar-collapse-header d-md-none">
						<div class="row">
							<div class="col-6 collapse-brand">
								<a href="dashboard.do"> <img
									src="assets/img/ùë≥ùíÇ ùë≠ùíêùíìùíé_newtitle1.png">
								</a>
							</div>
							<div class="col-6 collapse-close">
								<button type="button" class="navbar-toggler"
									data-toggle="collapse" data-target="#sidenav-collapse-main"
									aria-controls="sidenav-main" aria-expanded="false"
									aria-label="Toggle sidenav" style="background-color: black;"></button>
							</div>
						</div>
					</div>

					<!-- Form -->
					<form class="mt-4 mb-3 d-md-none">
						<div class="input-group input-group-rounded input-group-merge">
							<!-- Ï±óGPT API Îì§Ïñ¥Í∞à input ÌÉúÍ∑∏-->
							<input type="text"
								class="form-control form-control-rounded form-control-prepended"
								placeholder="ChatGPTÏóêÍ≤å Î¨ºÏñ¥Î≥¥ÏÑ∏Ïöî!" aria-label="Search">
							<div class="input-group-prepend">
								<div class="input-group-text">
									<span class="fa fa-search"></span>
								</div>
							</div>
						</div>
					</form>

					<!-- Navigation -->
					<ul class="navbar-nav">
						<li class="nav-item active"><a
							class="nav-link hover12 active" href="dashboard.do"> <i
								class="ni ni-chart-bar-32 text-red "></i> La Form Ìä∏Î†åÎìú Î∂ÑÏÑù
						</a></li>
						<li class="nav-item"><a class="nav-link hover12"
							href="productAnalysis.do"> <i
								class="ni ni-check-bold text-black"></i> Check'O Ï†úÌíà Î∂ÑÏÑù
						</a></li>
						<li class="nav-item"><a class="nav-link hover12"
							href="suggest.do"> <i class="ni ni-basket text-orange"></i>
								La Form Ï†úÏïàÏÑú <span class="badge badge-pill badge-dark"
								style="background-color: #4B0082; color: #FFD700; border: 2px solid #FFD700;">AI</span>
						</a></li>
					</ul>

				</div>
			</div>
	</nav>
	<div class="main-content">

		<!-- Navbar -->
		<nav class="navbar navbar-top navbar-expand-md navbar-dark"
			id="navbar-main">
			<div class="container-fluid">

				<!-- Brand -->
				<a
					class="h1 mb-0 text-black text-uppercase d-none d-lg-inline-block"
					href="dashboard.do">TREND ANALYSIS</a>

				<!-- Form -->
				<form
					class="navbar-search navbar-search-dark form-inline mr-3 d-none d-md-flex ml-lg-auto">
					<div class="form-group mb-0">
						<div class="input-group input-group-alternative">
							<div class="input-group-prepend">
								<span class="input-group-text"> <i class="fas fa-search"
									style="color: black;"></i>
								</span>
							</div>
							<!-- Ï±óGPT API Îì§Ïñ¥Í∞à input ÌÉúÍ∑∏-->
							<input class="form-control" placeholder="CahtGPTÏóêÍ≤å ÏßàÎ¨∏ÌïòÍ∏∞"
								type="text" id="promptInput" style="width: 850px;"
								onkeypress="if(event.keyCode=='13'){event.preventDefault(); gptSearch();}">
							<button type="submit" id="submitButton"
								style="visibility: hidden"></button>
						</div>
					</div>
				</form>

				<!-- User -->
				<ul class="navbar-nav align-items-center d-none d-md-flex">
					<li class="nav-item dropdown"><a class="nav-link pr-0"
						href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
						aria-expanded="false">
							<div class="media align-items-center">
								<div class="media-body ml-2 d-none d-lg-block">
									<span class="mb-0 text-sm  font-weight-bold"> <i
										class="fas fa-bars" style="color: black;"></i>
									</span>
								</div>
							</div>
					</a>
						<div class="dropdown-menu dropdown-menu-arrow dropdown-menu-right">
							<div class=" dropdown-header noti-title">
								<h6 class="text-overflow m-0">Welcome!</h6>
							</div>
							<div class="dropdown-divider"></div>
							<a href="logout.do" class="dropdown-item"> <i
								class="ni ni-user-run"></i> <span>Logout</span>
							</a>
						</div></li>
				</ul>
			</div>
		</nav>

		<!-- Header -->
		<div
			class="header bg-gradient-primary2 pb-8 pt-5 pt-md-8 position-relative">

			<!-- ÏúÑÏ™Ω Î≤ÑÌäº------------------------------------------------------------------------------------------------------>
			<div class="col" style="padding-left: 45px;">
				<ul class="nav nav-pills justify-content-start">
					<li class="nav-item mr-2 mr-md-0" data-toggle="chart"
						data-target="#chart-sales"
						data-update='{"data":{"datasets":[{"data":[0, 20, 10, 30, 15, 40, 20, 60, 60]}]}}'
						data-prefix="$" data-suffix="k"><a
						onclick="changeBoard('Í∞ìÏÉùÏÇ¥Í∏∞')" class="nav-link py-2 px-3 active"
						data-toggle="tab"> <span class="d-none d-md-block">Í∞ìÏÉù</span> <span
							class="d-md-none">Í∞ìÏÉù</span>
					</a></li>
					<li class="nav-item" data-toggle="chart" data-target="#chart-sales"
						data-update='{"data":{"datasets":[{"data":[0, 20, 5, 25, 10, 30, 15, 40, 40]}]}}'
						data-prefix="$" data-suffix="k"><a
						onclick="changeBoard('Ïä§Ìä∏Î†àÏä§')" class="nav-link py-2 px-3"
						data-toggle="tab"> <span class="d-none d-md-block">Ïä§Ìä∏Î†àÏä§</span>
							<span class="d-md-none">Ïä§Ìä∏Î†àÏä§</span>
					</a></li>
					<li class="nav-item" data-toggle="chart" data-target="#chart-sales"
						data-update='{"data":{"datasets":[{"data":[0, 20, 5, 25, 10, 30, 15, 40, 40]}]}}'
						data-prefix="$" data-suffix="k"><a
						onclick="changeBoard('ÌòàÎãπ')" class="nav-link py-2 px-3"
						data-toggle="tab"> <span class="d-none d-md-block">ÌòàÎãπ</span> <span
							class="d-md-none">ÌòàÎãπ</span>
					</a></li>
				</ul>
			</div>
			<!-- ÏúÑÏ™Ω Î≤ÑÌäº------------------------------------------------------------------------------------------------------>


			<div class="container-fluid">
				<div class="header-body">
					<!-- Card stats -->

				</div>
			</div>
		</div>

		<!-- Page content -->
		<div class="container-fluid mt--7">
			<div class="row">
				<div class="col-xl-12  mb-5 mb-xl-0">
					<div class="card shadow">
						<div class="card-header bg-transparent hover12">
							<div class="row align-items-center ">

								<div class="col">
									<h6 class="text-uppercase text-black ls-1 mb-1">Keyword
										TOP 10</h6>
									<h2 class="text-black mb-0">ÌÇ§ÏõåÎìú TOP 10</h2>
								</div>

								<div class="col"></div>
							</div>
						</div>
						<div class="card-body " style="background-color: #ffffff;">

							<!-- Chart -->
							<div class="chart" id="divBarChart">
								<canvas id="011"
									style="display: block; height: 355px; width: 1550px;"></canvas>
							</div>

						</div>
					</div>
				</div>
			</div>

			<!--ÌñâÎ≥µÌïòÎã§-------------------------------------------------------------------------------------------->
			<div class="row">
				<div class="col-xl-4 col-lg-6 "
					style="padding-top: 20px; padding-bottom: 20px;">
					<div class="card card-stats mb-4 mb-xl-0 ">
						<div class="card-body">
							<div class="row">
								<div class="col">
									<h5 class="card-title text-uppercase text-muted mb-0">Í∏çÏ†ï</h5>
									<span class="h2 font-weight-bold mb-0 hover12"
										id="positiveWord">ÌñâÎ≥µÌïòÎã§</span>
								</div>
								<div class="col-auto">
									<div
										class="icon icon-shape bg-green text-white rounded-circle shadow">
										<i class="fas fa-smile"></i>
									</div>
								</div>
							</div>
							<p class="mt-3 mb-0 text-muted text-sm">
								<span class="text-success mr-2"><i class="fa fa-arrow-up"></i>
									TOP1</span> <span class="text-nowrap">Ìä∏Î†åÎìú ÌÇ§ÏõåÎìú</span>
							</p>

						</div>
					</div>
				</div>

				<!--Î∂àÌñâÌïòÎã§----------------------------------------------------------------------------------------->
				<div class="col-xl-4 col-lg-6 "
					style="padding-top: 20px; padding-bottom: 20px;">
					<div class="card card-stats mb-4 mb-xl-0 ">
						<div class="card-body">
							<div class="row">
								<div class="col">
									<h5 class="card-title text-uppercase text-muted mb-0">Î∂ÄÏ†ï</h5>
									<span class="h2 font-weight-bold mb-0 hover12"
										id="negativeWord">Î∂àÌñâÌïòÎã§</span>
								</div>
								<div class="col-auto">
									<div
										class="icon icon-shape bg-red text-white rounded-circle shadow">
										<i class="fas fa-frown"></i>
									</div>
								</div>
							</div>
							<p class="mt-3 mb-0 text-muted text-sm">
								<span class="text-danger mr-2"><i
									class="fas fa-arrow-down"></i> TOP1</span> <span class="text-nowrap">Ìä∏Î†åÎìú
									ÌÇ§ÏõåÎìú</span>
							</p>
						</div>
					</div>
				</div>

				<!--test------------------------------------------------------------------------------------------>
				<div class="col-xl-4 col-lg-6"
					style="padding-top: 20px; padding-bottom: 20px;">
					<div class="card card-stats mb-4 mb-xl-0">
						<div class="card-body">
							<div class="row">
								<div class="col">
									<h5 class="card-title text-uppercase text-muted mb-0">Ï∂îÏ∂úÎêú
										Îã®Ïñ¥Ïùò Í∞ØÏàò</h5>
									<span class="h2 font-weight-bold mb-0 hover12" id="dataSize"></span>
								</div>
								<div class="col-auto">
									<div
										class="icon icon-shape bg-yellow text-white rounded-circle shadow">
										<i class="fas fa-users"></i>
									</div>
								</div>
							</div>
							<p class="mt-3 mb-0 text-muted text-sm">
								<span class="text-warning mr-2"></span> <span
									class="text-nowrap"></span>
							</p>
						</div>
					</div>
				</div>

			</div>


			<!---------------------------ÏõåÎìúÌÅ¥ÎùºÏö∞Îìú------------------------------------------------------------------------------->
			<div class="row">
				<div class="col-xl-8  mb-5 mb-xl-0">
					<div class="card shadow">
						<div class="card-header bg-transparent hover12">
							<div class="row align-items-center">
								<div class="col">
									<h6 class="text-uppercase text-black ls-1 mb-1">Wordcloud</h6>
									<h2 class="text-black mb-0">ÏõåÎìúÌÅ¥ÎùºÏö∞Îìú</h2>
								</div>
							</div>
						</div>
						<div class="card-body"
							style="background-color: #ffffff; padding: 0px;" padding
							id="wordCloud">
							<img
								src="${pageContext.request.contextPath}/resources/img/Í∞ìÏÉùÏÇ¥Í∏∞.png"
								alt=""
								style="max-height: 420px; object-fit: cover; padding: 1.5rem; margin-left: 100px">
						</div>
					</div>
				</div>



				<!------------------------------------Í∏çÏ†ï, Î∂ÄÏ†ï Í∑∏ÎûòÌîÑ------------------------------------------------------------------------->
				<div class="col-xl-4">
					<div class="card shadow">

						<div
							class="card-header bg-gradient-default1  bg-transparent hover12">
							<div class="row align-items-center">

								<div class="col">
									<h6 class="text-uppercase text-black ls-1 mb-1">Positive,
										Negative</h6>
									<h2 class="mb-0">Í∏çÏ†ï, Î∂ÄÏ†ï</h2>
								</div>

							</div>
						</div>
						<div class="card-body" style="padding-bottom: 50px;">



							<!-- Chart -->
							<div class="chart" id="divDonutChart">
								<canvas id="010"></canvas>
							</div>
						</div>
					</div>
				</div>
			</div>


			<!-----------------------------Î∏îÎ°úÍ∑∏ Îâ¥Ïä§ Îì±----------------------------------------------------------------------------->
			<div class="col-xl-81 mb-5 mb-xl-0"></div>
			<div class="card shadow">
				<div class="card-header bg-gradient-default1 border-0 hover12">
					<div class="row align-items-center">
						<div class="col">
							<h3 class="mb-0">Î∏îÎ°úÍ∑∏</h3>
						</div>
					</div>
				</div>
				<div class="table-responsive scrollbar">

					<table class="table align-items-center table-flush">

						<thead class="thead-light">

						</thead>


						<tbody id="searchResult">
						</tbody>
					</table>


				</div>
			</div>



			<!-- Modal -->
			<div id="naverModal" class="modal fade" role="dialog">
				<div class="modal-dialog" style="width: 80%; max-width: 1200px;">
					<!-- Ïä§ÌÉÄÏùº Ï∂îÍ∞Ä -->
					<!-- Modal content-->
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal">&times;</button>
						</div>
						<div class="modal-body" style="height: 700px;">
							<!-- Ïä§ÌÉÄÏùº Ï∂îÍ∞Ä -->
							<iframe id="naverIframe"
								style="width: 100%; height: 100%; border: none;"></iframe>
						</div>
					</div>
				</div>
			</div>

			<div class="modal fade" id="gptModal" role="dialog">
				<div class="modal-dialog modal-sm">
					<div class="modal-content">
						<div class="modal-header">
							<h4 class="modal-title">ChatGPT</h4>
							<button type="button" class="close" data-dismiss="modal">&times;</button>

						</div>
						<div class="modal-body" id="gptResponse"></div>
					</div>
				</div>
			</div>
		</div>

		<!-----------------------footer----------------------------------------------------------------------->
		<footer class="footer">
			<div class="row align-items-center justify-content-xl-between">
				<div class="col-xl-6">
					<div class="copyright text-center text-xl-left text-muted">
						&copy; 2024 <a href="https://www.naver.com"
							class="font-weight-bold ml-1" target="_blank">Í¥ÄÎ¶¨Ïûê ÏöîÏ≤≠ÌïòÍ∏∞</a>
					</div>
				</div>
				<div class="col-xl-6">
					<ul
						class="nav nav-footer justify-content-center justify-content-xl-end">
						<li class="nav-item"><a href="https://www.naver.com"
							class="nav-link" target="_blank">Í¥ÄÎ¶¨Ïûê ÏöîÏ≤≠ÌïòÍ∏∞</a></li>
						<li class="nav-item"><a href="https://checko.kr"
							class="nav-link" target="_blank">Ï≤¥ÌÅ¨Ïò§</a></li>
						<li class="nav-item"><a href="https://grandalphakhk.com"
							class="nav-link" target="_blank">Í∑∏ÎûëÏïåÌåå</a></li>
						<li class="nav-item"><a href="https://smhrd.or.kr/"
							class="nav-link" target="_blank">SMHRD</a></li>
					</ul>
				</div>
			</div>
		</footer>
		<!-----------------------footer----------------------------------------------------------------------->

	</div>
	</div>
	<!--   Core   -->
	<script
		src="${pageContext.request.contextPath}/resources/js/plugins/jquery/dist/jquery.min.js"></script>
	<script
		src="${pageContext.request.contextPath}/resources/js/plugins/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
	<!--   Optional JS   -->
	<script
		src="${pageContext.request.contextPath}/resources/js/plugins/chart.js/dist/Chart.min.js"></script>
	<script
		src="${pageContext.request.contextPath}/resources/js/plugins/chart.js/dist/Chart.extension.js"></script>
	<!--Ï∞®Ìä∏-->
	<script src="node_modules/chart.js/dist/chart.umd.js"></script>
	<!--   Argon JS   -->
	<script
		src="${pageContext.request.contextPath}/resourcesjs/argon-dashboard.min.js?v=1.1.2"></script>
	<script src="https://cdn.trackjs.com/agent/v3/latest/t.js"></script>
	<script src="${pageContext.request.contextPath}/resources/js/sakura.js"
		text="text/javascript"></script>
	<script>

    //---------------------------------------------------------------------------------------
    
    // Í∏çÏ†ï Î∂ÄÏ†ï
    // ÎèÑÎÑõÏ∞®Ìä∏
    window.TrackJS && // TrackJSÍ∞Ä Ï†ïÏùòÎêòÏñ¥ ÏûàÏúºÎ©¥
      TrackJS.install({ // TrackJSÎ•º ÏÑ§Ïπò
        token: "ee6fab19c5a04ac1a32a645abde4613a", // Ï∂îÏ†Å ÌÜ†ÌÅ∞ ÏÑ§Ï†ï
        application: "argon-dashboard-free" // Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò Ïù¥Î¶Ñ ÏÑ§Ï†ï
      });

    function donutChart(request) { 
    	$.ajax({
    		url: "getDeepPN",
    		data: {deep_source: request},
    		success: function(data){
    			//console.log(data);
    
      $('#010').remove();
    $('#divDonutChart').append('<canvas id="010"></canvas>');

    	
      var ctx = document.getElementById('010').getContext('2d'); // idÍ∞Ä '010'Ïù∏ Ï∫îÎ≤ÑÏä§ ÏöîÏÜåÎ•º Í∞ÄÏ†∏ÏôÄ 2D Ïª®ÌÖçÏä§Ìä∏ ÏñªÍ∏∞
      var myChart = new Chart(ctx, { // ÏÉàÎ°úÏö¥ Chart Í∞ùÏ≤¥ ÏÉùÏÑ±
        type: 'doughnut', // Ï∞®Ìä∏ Ïú†ÌòïÏùÑ 'ÎèÑÎÑõÌòï'ÏúºÎ°ú ÏÑ§Ï†ï
        data: {
          labels: ['Î∂ÄÏ†ï', 'Í∏çÏ†ï'], // ÎèÑÎÑõ Ï∞®Ìä∏Ïùò Î†àÏù¥Î∏î
          datasets: [{
            label: 'Market Share', // Îç∞Ïù¥ÌÑ∞ÏÖãÏùò Î†àÏù¥Î∏î
            data: data, // Í∞Å Î†àÏù¥Î∏îÏóê Ìï¥ÎãπÌïòÎäî Îç∞Ïù¥ÌÑ∞ Í∞í
            backgroundColor: ['#F5365C', '#2DCC70'], // Í∞Å Îç∞Ïù¥ÌÑ∞ Ï°∞Í∞ÅÏùò Î∞∞Í≤ΩÏÉâ ÏÑ§Ï†ï
            borderColor: [], // Í∞Å Îç∞Ïù¥ÌÑ∞ Ï°∞Í∞ÅÏùò ÌÖåÎëêÎ¶¨ ÏÉâÏÉÅ ÏÑ§Ï†ï (ÌòÑÏû¨ ÏóÜÏùå)
            borderWidth: 10 // Îç∞Ïù¥ÌÑ∞ Ï°∞Í∞ÅÏùò ÌÖåÎëêÎ¶¨ ÎÑàÎπÑ ÏÑ§Ï†ï
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: true,
              position: 'chartArea',
              align: 'center'
            },
            tooltip: {
              enabled: true,
              backgroundColor: 'rgba(0, 0, 0, 0.7)',
              titleColor: '#ffffff',
              bodyColor: '#ffffff', 
              borderWidth: 1, 
              borderColor: '#ddd', 
            }
          },
          cutoutPercentage: 50
        }
      });
      
    		},
    		error: function(){
    			alert("Ïó∞Í≤∞ Ïã§Ìå® „Öú„Öú");
    		}
    	});
    }

    //---------------------------------------------------------------------------------------

    // ÌÇ§ÏõåÎìú ÌÉë10
    // Î∞îÏ∞®Ìä∏
  function barChart(list, request) {

    const rList = list.filter(item => item.trend_source === request);
    const groupedTrends = {};

    rList.forEach(trend => {
        const key = trend.trend_keyword;
        if (!groupedTrends[key]) {
            groupedTrends[key] = { trend_keyword: key, trend_sum: 0 };
        }
        groupedTrends[key].trend_sum += trend.trend_sum; // ÌÇ§ÏõåÎìúÍ∞Ä Í∞ôÏùÑ Îïå ÎπàÎèÑÏàòÎ•º ÎàÑÏ†Å
    });

    // trend_sumÏùÑ Í∏∞Ï§ÄÏúºÎ°ú ÎÇ¥Î¶ºÏ∞®ÏàúÏúºÎ°ú Ï†ïÎ†¨ÌïòÍ≥† ÏÉÅÏúÑ 10Í∞úÎ•º ÏÑ†ÌÉùÌï©ÎãàÎã§.
    const top10Trends = Object.values(groupedTrends)
        .sort((a, b) => b.trend_sum - a.trend_sum)
        .slice(0, 10);

    const labels = top10Trends.map(trend => trend.trend_keyword);
    const data = top10Trends.map(trend => trend.trend_sum);

    $('#011').remove();
    $('#divBarChart').append('<canvas id="011" style="display: block;height: 355px;width: 1550px;"></canvas>');

    let canvas = document.getElementById('011');
    let ctx = canvas.getContext('2d');

    let chart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Trend Sum',
                data: data,
                backgroundColor: '#8467D7',
            }]
        },
        options: {
            responsive: true,
            indexAxis: 'y',
            plugins: {
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Top 10 Trends'
                },
            },
            scales: {
                x: {
                    title: {
                        display: true,
                        text: 'Trend Sum'
                    },
                    beginAtZero: true
                },
                y: {
                    title: {
                        display: true,
                        text: 'Keyword'
                    },
                    ticks: {
                        autoSkip: false
                    }
                }
            }
        }
    });
}

    //---------------------------------------------------------------------------------------
    document.addEventListener("DOMContentLoaded", function () {
      const container = document.getElementById("particle-1");
      const texts = [" ", "La form", "Dashboard"];
      const gap = 1;
      function createParticles() {
        for (let i = 0; i < 3; i++) {
          const particle = document.createElement("div");
          particle.classList.add("particle");
          particle.textContent = texts[i];
          particle.style.left = i * gap + "px";
          container.appendChild(particle);
        }
      }
      createParticles();
      document.addEventListener("mousemove", function (event) {
        const particles = document.querySelectorAll(".particle");
        particles.forEach((particle, index) => {
          const newPositionX = event.clientX + index * 20;
          const newPositionY = event.clientY + index * 20;
          particle.style.left = newPositionX + "px";
          particle.style.top = newPositionY + "px";
        });
      });
    });

    //---------------------------------------------------------------------------------------
    var sakura = new Sakura('body', {
      colors: [
        {
          gradientColorStart: 'rgba(255, 183, 197, 0.9)',
          gradientColorEnd: 'rgba(255, 197, 208, 0.9)',
          gradientColorDegree: 120,
        },
        {
          gradientColorStart: 'rgba(255,189,189)',
          gradientColorEnd: 'rgba(227,170,181)',
          gradientColorDegree: 120,
        },
        {
          gradientColorStart: 'rgba(212,152,163)',
          gradientColorEnd: 'rgba(242,185,196)',
          gradientColorDegree: 120,
        },
      ],
      delay: 600,
    });
    
    //------------------------------------------------------------------------
   	//htmlÏù¥ Î°úÎìú ÎêêÏùÑÎïå 
   $(document).ready(function() { 
	   changeBoard('Í∞ìÏÉùÏÇ¥Í∏∞')
	  
   });

	//ÎåÄÏãúÎ≥¥Îìú Í∞í DBÏó∞Í≤∞
	function changeBoard(request){
		naverSearch(request)
		donutChart(request)
		ChangeWordCloud(request)
		positiveWord(request)
		negativeWord(request)
		dataSize(request)
		
		$.ajax({
			url:'trendList',
			type:'GET',
			success: function(response) {
				 let tList = JSON.stringify(response, null, 2)
				 barChart(JSON.parse(tList),request)
				
			},
			error:function(xhr, status, error) {
	            console.error("ÏóêÎü¨ Î∞úÏÉù:", error);
	        }
		})
	}
	
//-----------------------------------------------------------------------------------
	//ÏõåÎìúÌÅ¥ÎùºÏö∞Îìú 
	var contextPath = "${pageContext.request.contextPath}";
	function ChangeWordCloud(request){
	//console.log("ÏõåÎìúÌÅ¥ÎùºÏö∞Îìú"+request)
		// wordCloud ÏöîÏÜåÎ•º ÏÑ†ÌÉù
	    var wordCloudElement = document.getElementById('wordCloud');
	    
	    // wordCloud ÏöîÏÜå ÏïàÏùò img ÌÉúÍ∑∏Î•º ÏÑ†ÌÉù
	    var imgElement = wordCloudElement.querySelector('img');
	    
	    // img ÌÉúÍ∑∏Ïùò src ÏÜçÏÑ±ÏùÑ Î≥ÄÍ≤Ω
	    imgElement.src = contextPath + '/resources/img/' + request + '.png';
}


//------------------------------------------------------------------------------------------
	
	//Í∏çÏ†ï top1
	function positiveWord(request){
	//console.log(request)
    	$.ajax({
    		url: "getBest",
    		data: {deep_source: request},
    		success: function(data){
    			//console.log(data);
    			$("#positiveWord").text(data.deep_result)
				
			},
			error:function(xhr, status, error) {
	            console.error("ÏóêÎü¨ Î∞úÏÉù:", error);
	        }
		})
	}
	
	//Î∂ÄÏ†ï top1
		function negativeWord(request){
			$.ajax({
	    		url: "getWorst",
	    		data: {deep_source: request},
	    		success: function(data){
	    			//console.log(data);
	    			$("#negativeWord").text(data.deep_result)
					
				},
				error:function(xhr, status, error) {
		            console.error("ÏóêÎü¨ Î∞úÏÉù:", error);
		        }
			})
	
	}
	
	
	//Ï∂îÏ∂úÎêú ÌÇ§ÏõåÎìúÎüâ
	 function dataSize(request){
		 $.ajax({
	    		url: "getDataSize",
	    		data: {deep_source: request},
	    		success: function(data){
	    			console.log(data);
	    			let formattedData = data.toLocaleString();
	    			$("#dataSize").text(formattedData)
					
				},
				error:function(xhr, status, error) {
		            console.error("ÏóêÎü¨ Î∞úÏÉù:", error);
		        }
			})
	}
//---------------------------------------------------------------------------------------------
    
   	//ÎÑ§Ïù¥Î≤Ñ api 
    function naverSearch(query){
	$.ajax({
        url: 'naver',  // Î∞±ÏóîÎìúÏùò /naver ÏóîÎìúÌè¨Ïù∏Ìä∏ Ìò∏Ï∂ú
        type: 'GET',    // HTTP Î©îÏÜåÎìú
        contentType: 'application/json;charset:UTF-8', // Î∞òÌôòÎ∞õÏùÑ Îç∞Ïù¥ÌÑ∞Ïùò ÌÉÄÏûÖ
        data: { query: query },  // ÏÑúÎ≤ÑÎ°ú Î≥¥ÎÇº Îç∞Ïù¥ÌÑ∞
        success: function(response) {
          //  console.log("ÏÑúÎ≤ÑÎ°úÎ∂ÄÌÑ∞Ïùò ÏùëÎãµ:", response);
            innerHtml=""
            	
            for(let i = 0; i<response.items.length;i++){
            	var url = ensureCompleteUrl(response.items[i].link);
            	innerHtml +="<tr>"
            	innerHtml += "<td><h3><a onclick='modalOpen(\"" + url + "\")'>" + response.items[i].title + "</a></h3>";
            	innerHtml += "<a onclick='modalOpen(\"" + url + "\")'>" + response.items[i].description + "</a></td>";
            	innerHtml +="<tr>"
            }
            	
            $("#searchResult").html(innerHtml)
        },
        error: function(xhr, status, error) {
            console.error("ÏóêÎü¨ Î∞úÏÉù:", error);
        }
    });
}


function ensureCompleteUrl(url) { //ÎÑ§Ïù¥Î≤Ñ Í≤ÄÏÉâÏúºÎ°ú Î∞õÏïÑÏò® link Î≥ÄÌôò
	  if (!url.startsWith('http://') && !url.startsWith('https://')) {
	    return 'https://' + url; // Í∏∞Î≥∏Ï†ÅÏúºÎ°ú httpsÎ•º ÏÇ¨Ïö©ÌïòÍ±∞ÎÇò ÌïÑÏöîÏóê Îî∞Îùº Ï°∞Ï†ï
	  }
	  return url;
	}


function modalOpen(link) {
    $('#naverModal').modal("show");
    $('#naverIframe').attr('src', link); // iFrameÏùò src ÏÜçÏÑ± ÏÑ§Ï†ï
}

//-------------------------------------------------------------------------------------------
 //GPT API Ïã§Ìñâ 
 function gptSearch(){
		var myData =$("#promptInput").val()
    $.ajax({
        url: 'chat',
        type: 'POST',
        contentType: 'application/json;charset:UTF-8',
        data: JSON.stringify({ prompt: myData }),
        success: function(response) {
            console.log("ÏÑúÎ≤ÑÎ°úÎ∂ÄÌÑ∞Ïùò ÏùëÎãµ:", response);
            $("#gptResponse").html(response)
            $('#gptModal').modal("show");
        },
        error: function(xhr, status, error) {
            console.error("ÏóêÎü¨ Î∞úÏÉù:", error);
        }
    });
		
		$("#promptInput").val("")
}
  

  </script>

</body>

</html>